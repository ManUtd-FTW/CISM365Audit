<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>CIS Microsoft 365 Audit Results</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <style>
    :root{
      --bg:#ffffff; --fg:#222; --muted:#666; --border:#e0e0e0;
      --pill-pass:#2e7d32; --pill-fail:#c62828; --pill-man:#ef6c00; --pill-err:#6d4c41;
      --link:#0366d6; --panel:#f9f9f9;
    }
    *{box-sizing:border-box}
    body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Arial,sans-serif;margin:24px;background:var(--bg);color:var(--fg)}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px}
    .title{font-size:22px;font-weight:600}
    .logo{max-height:40px;margin-left:12px}
    .sub{color:var(--muted);font-size:13px;margin-top:4px}
    .summary{margin:12px 0 24px 0}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;color:#fff;font-size:12px;margin-right:8px}
    .p-pass{background:var(--pill-pass)}
    .p-fail{background:var(--pill-fail)}
    .p-man {background:var(--pill-man)}
    .p-err {background:var(--pill-err)}
    .grid{display:grid;grid-template-columns:1fr;gap:16px}
    .control{border:1px solid var(--border);border-radius:8px;padding:14px;background:#fff}
    .control-header{display:flex;align-items:flex-start;justify-content:space-between;gap:12px}
    .control-title{font-size:16px;font-weight:600}
    .cid{display:inline-block;background:#eef2ff;color:#334155;border:1px solid #c7d2fe;border-radius:6px;padding:2px 6px;margin-right:6px;font-size:12px}
    .control-status{font-weight:600}
    .meta{margin-top:6px;color:var(--muted);font-size:12px}
    .meta-pill{display:inline-block;border:1px solid var(--border);border-radius:999px;padding:2px 8px;margin-right:6px;background:#fafafa}
    .details{margin-top:8px}
    .collapsible{color:var(--link);text-decoration:none;font-size:13px}
    .details-panel{display:none;margin-top:8px;background:var(--panel);border:1px solid var(--border);border-radius:6px;padding:10px}
    a { color: var(--link); }
    @media (min-width: 900px){
      .grid{grid-template-columns:1fr 1fr}
    }
  </style>
  <script>
    function toggle(id){
      var e=document.getElementById(id);
      if(!e) return;
      e.style.display = (e.style.display === 'none' || e.style.display === '') ? 'block' : 'none';
    }
  </script>
</head>
<body>
  <header>
    <div>
      <div class="title">CIS Microsoft 365 Audit Results</div>
      <div class="sub">Tenant: visecurityinc.onmicrosoft.com &nbsp;&middot;&nbsp; Cloud: Global &nbsp;&middot;&nbsp; Generated: 2025-09-04 20:28 -04:00</div>
    </div>
    <div></div>
  </header>

  <section class="summary">
    <span class="pill p-pass">PASS: 0</span>
    <span class="pill p-fail">FAIL: 0</span>
    <span class="pill p-man">MANUAL: 3</span>
    <span class="pill p-err">ERROR: 2</span>
    <span class="pill" style="background:#374151">TOTAL: 5</span>
  </section>

  <section class="grid">
    <div class="control">
  <div class="control-header">
    <div class="control-title"><span class="cid">1.1.3</span> Ensure that between two and four Global Administrators are designated</div>
    <div class="control-status" style="color: #6d4c41;">ERROR: One or more errors occurred. (SessionNotInitialized)</div>
  </div>
  <div class="meta">
    <span class="meta-pill">Profile: L1</span>
    <span class="meta-pill">Automated</span>
  </div>
  <div class="details">
    <a class="collapsible" href="javascript:void(0)" onclick="toggle('d1')">Show Details</a>
    <div id="d1" class="details-panel">
      <p><strong>Description:</strong> Limit the number of Global Administrators to reduce risk.</p>
      <p><strong>Rationale:</strong> Too many global admins increase the attack surface and the blast radius of compromised credentials.</p>
      <p><strong>References:</strong> <a href="https://learn.microsoft.com/entra/identity/role-based-access-control/permissions-reference" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/entra/identity/role-based-access-control/permissions-reference</a></p>
    </div>
  </div>
</div>
<div class="control">
  <div class="control-header">
    <div class="control-title"><span class="cid">1.2.1</span> Ensure Security Defaults is enabled</div>
    <div class="control-status" style="color: #ef6c00;">MANUAL (Unable to retrieve Security Defaults: One or more errors occurred. (SessionNotInitialized))</div>
  </div>
  <div class="meta">
    <span class="meta-pill">Profile: L1</span>
    <span class="meta-pill">Automated</span>
  </div>
  <div class="details">
    <a class="collapsible" href="javascript:void(0)" onclick="toggle('d2')">Show Details</a>
    <div id="d2" class="details-panel">
      <p><strong>Description:</strong> Security Defaults enforce baseline identity protections such as MFA for administrators.</p>
      <p><strong>Rationale:</strong> Enabling Security Defaults helps protect the tenant from common identity attacks with minimal configuration.</p>
      <p><strong>References:</strong> <a href="https://learn.microsoft.com/graph/api/identitysecuritydefaultsenforcementpolicy-get?view=graph-rest-1.0" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/graph/api/identitysecuritydefaultsenforcementpolicy-get?view=graph-rest-1.0</a>, <a href="https://learn.microsoft.com/powershell/module/microsoft.graph.identity.signins/get-mgpolicyidentitysecuritydefaultenforcementpolicy?view=graph-powershell-1.0" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/powershell/module/microsoft.graph.identity.signins/get-mgpolicyidentitysecuritydefaultenforcementpolicy?view=graph-powershell-1.0</a></p>
    </div>
  </div>
</div>
<div class="control">
  <div class="control-header">
    <div class="control-title"><span class="cid">1.3.1</span> Ensure MFA is enabled for all users</div>
    <div class="control-status" style="color: #ef6c00;">MANUAL (Unable to check MFA registration via Graph: One or more errors occurred. (SessionNotInitialized))</div>
  </div>
  <div class="meta">
    <span class="meta-pill">Profile: L1</span>
    <span class="meta-pill">Automated</span>
  </div>
  <div class="details">
    <a class="collapsible" href="javascript:void(0)" onclick="toggle('d3')">Show Details</a>
    <div id="d3" class="details-panel">
      <p><strong>Description:</strong> All users should register at least one strong MFA method. (Registration is a prerequisite; enforcement is typically via Conditional Access policies.)</p>
      <p><strong>Rationale:</strong> MFA significantly reduces the risk of account compromise from phishing and credential theft.</p>
      <p><strong>References:</strong> <a href="https://learn.microsoft.com/graph/api/resources/authenticationmethods-usage-insights-overview" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/graph/api/resources/authenticationmethods-usage-insights-overview</a>, <a href="https://learn.microsoft.com/graph/api/reportroot-list-userregistrationdetails?view=graph-rest-1.0" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/graph/api/reportroot-list-userregistrationdetails?view=graph-rest-1.0</a></p>
    </div>
  </div>
</div>
<div class="control">
  <div class="control-header">
    <div class="control-title"><span class="cid">2.1.4</span> Ensure Safe Attachments policy is enabled</div>
    <div class="control-status" style="color: #ef6c00;">MANUAL (Safe Attachments cmdlets are unavailable in this session)</div>
  </div>
  <div class="meta">
    <span class="meta-pill">Profile: L2</span>
    <span class="meta-pill">Automated</span>
  </div>
  <div class="details">
    <a class="collapsible" href="javascript:void(0)" onclick="toggle('d4')">Show Details</a>
    <div id="d4" class="details-panel">
      <p><strong>Description:</strong> Verify that Safe Attachments protection is in effect via at least one enabled Safe Attachments rule with a policy that blocks (or dynamically delivers) malicious attachments.</p>
      <p><strong>Rationale:</strong> Safe Attachments detonates attachments in a virtual environment to detect unknown malware before delivery, reducing infection risk from email-borne threats.</p>
      <p><strong>References:</strong> <a href="https://learn.microsoft.com/powershell/module/exchangepowershell/get-safeattachmentpolicy?view=exchange-ps" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/powershell/module/exchangepowershell/get-safeattachmentpolicy?view=exchange-ps</a>, <a href="https://learn.microsoft.com/powershell/module/exchangepowershell/get-safeattachmentrule?view=exchange-ps" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/powershell/module/exchangepowershell/get-safeattachmentrule?view=exchange-ps</a>, <a href="https://learn.microsoft.com/defender-office-365/safe-attachments-policies-configure" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/defender-office-365/safe-attachments-policies-configure</a>, <a href="https://learn.microsoft.com/defender-office-365/safe-attachments-about" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/defender-office-365/safe-attachments-about</a></p>
    </div>
  </div>
</div>
<div class="control">
  <div class="control-header">
    <div class="control-title"><span class="cid">2.1.9</span> Ensure that DKIM is enabled for all Exchange Online domains</div>
    <div class="control-status" style="color: #6d4c41;">ERROR: The term &#39;Get-AcceptedDomain&#39; is not recognized as a name of a cmdlet, function, script file, or executable program.
Check the spelling of the name, or if a path was included, verify that the path is correct and try again.</div>
  </div>
  <div class="meta">
    <span class="meta-pill">Profile: L1</span>
    <span class="meta-pill">Automated</span>
  </div>
  <div class="details">
    <a class="collapsible" href="javascript:void(0)" onclick="toggle('d5')">Show Details</a>
    <div id="d5" class="details-panel">
      <p><strong>Description:</strong> DKIM should be enabled for all custom accepted domains (non-onmicrosoft.com).</p>
      <p><strong>Rationale:</strong> DKIM helps prevent spoofing by cryptographically signing outbound mail.</p>
      <p><strong>References:</strong> <a href="https://learn.microsoft.com/powershell/module/exchangepowershell/get-dkimsigningconfig?view=exchange-ps" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/powershell/module/exchangepowershell/get-dkimsigningconfig?view=exchange-ps</a></p>
    </div>
  </div>
</div>

  </section>
</body>
</html>
